language: java
sudo: required
jdk:
- oraclejdk8
env:
  matrix:
    - SERV=lucee4
    - SERV=lucee5
    - SERV=cf2016
    - SERV=cf11 
before_install:
- sudo apt-key adv --keyserver keys.gnupg.net --recv 6DA70622
- sudo echo "deb http://downloads.ortussolutions.com/debs/noarch /" | sudo tee -a
  /etc/apt/sources.list.d/commandbox.list
install:
- sudo apt-get update && sudo apt-get --assume-yes install commandbox
- box install cfwheels-cli
before_script:
- box server start $SERV
script: >
  testResults="$(box wheels test core $SERV )";
  echo "$testResults"; 
  if grep -i "\Tests Complete: All Good!" <<< $testResults;  then exit 1; fi
notifications:
    email: false
